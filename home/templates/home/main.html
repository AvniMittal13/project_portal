{% extends 'home/base.html' %}
{% block content %}
{% load crispy_forms_tags %}
<div class="row">

    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-warning shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                            <a href="{% url 'projects-applied'%}" style="color:#EE7210">Projects Applied</a>
                        </div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ num_projects_applied }}</div>
                    </div>
                    <!-- <div class="col-auto">
                            <i class="fas fa-comments fa-2x text-gray-300"></i>
                        </div> -->
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-warning shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                            <a href="{% url 'projects-floated'%}" style="color:#EE7210">Projects Floated</a>
                        </div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ num_projects_floated }}</div>
                    </div>
                    <!-- <div class="col-auto">
                            <i class="fas fa-comments fa-2x text-gray-300"></i>
                        </div> -->
                </div>
            </div>
        </div>
    </div>


    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-warning shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                            <a href="{% url 'projects-requested'%}" style="color:#EE7210">Projects Requested</a>
                        </div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ num_projects_req }}</div>
                    </div>
                    <!-- <div class="col-auto">
                            <i class="fas fa-comments fa-2x text-gray-300"></i>
                        </div> -->
                </div>
            </div>
        </div>
    </div>


    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-warning shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                            <a href="{% url 'projects-starred'%}" style="color:#EE7210">Projects Starred</a>
                        </div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ user.profile.starred_projects.count }}
                        </div>
                    </div>
                    <!-- <div class="col-auto">
                            <i class="fas fa-comments fa-2x text-gray-300"></i>
                        </div> -->
                </div>
            </div>
        </div>
    </div>
</div>
{% if messages %}
{% for message in messages %}
<div class="card-header py-3" >{{message}}</div>
{% endfor %}
{% endif %}


<!-- Filter options -->
<form method="get">
    {{myFilter.form|crispy}}
    <button class="btn btn-primary" type="Submit">Filter</button>
</form>

<style>
    .demo-2 {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  max-width: 300px;
}
</style>


<div class="project_cards">

    <h2 style="padding-top: 20px;">Projects :</h2>
    <br>
    <div style="display: flex; flex-wrap: wrap;">
    {% for project in projects %}

    <!-- Collapsable Card Example -->
    <!-- <div class="col-lg-6"> -->
    <!-- Basic Card Example -->
    <div class="card shadow mb-4" style="flex: 1 0 30%; margin-left: 20px;">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary"><a href="{% url 'project' project.id %}"> {{ project.Title }}
                </a> </h6>
        </div>
        <div class="card-body" >
            {{ project.Description }}
            <br><br>

        <div style="display: flex; flex-direction: row; justify-content: space-evenly; ">
            {% if project.id in user_requested_projects_id %}
            <a href="{% url 'task-project' project.id projects.number 'Withdraw'%}"><button
                    class="btn btn-primary btn-user btn-block" style="width:150%; ">Withdraw Request</button></a>
            {% else %}
            {% if project.id not in user_projects_id %}
            <a href="{% url 'task-project' project.id projects.number 'Apply'%}"><button
                    class="btn btn-primary btn-user btn-block" style="width:150%; ">Apply</button></a>
            {% else %}
            <a href="{% url 'task-project' project.id projects.number 'Leave'%}"><button
                    class="btn btn-primary btn-user btn-block" style="width:150%; ">Leave</button></a>
            {% endif %}
            {% endif %}

            
            {% if project.id not in user_starred_projects_id %}
            <a href="{% url 'task-project' project.id projects.number 'Star'%}"><button
                    class="btn btn-primary btn-user btn-block" style="width:150%;">Star</button></a>
            {% else %}
            <a href="{% url 'task-project' project.id projects.number 'Unstar'%}"><button
                    class="btn btn-primary btn-user btn-block" style="width:150%;">Unstar</button></a>
            {% endif %}

          
        </div>
        </div>
    </div>

    
    <!-- </div> -->

    {% endfor %}
    </div>

</div>


{% with request.get_full_path as querystring %}
    {% if projects.has_other_pages %}
        <ul class="pagination">
            {% if projects.has_previous %}
                {% if 'Status' in querystring %}
                    {% if 'page' in querystring %}
                        <li><a href="{{ querystring|slice:":-1" }}{{ projects.previous_page_number }}">&laquo;</a></li>
                    {% else %}
                        <li><a href="{{ querystring }}&page={{ projects.previous_page_number }}">&laquo;</a></li>
                    {% endif %}
                {% else %}
                    <li><a href="/?page={{ projects.previous_page_number }}">&laquo;</a></li>
                {% endif %}
            {% endif %}
            {% for i in projects.paginator.page_range %}
                {% if projects.number == i %}
                <li class="active"><span>{{ i }} <span class="sr-only">(current)</span></span></li>
                {% else %}
                    {% if 'Status' in querystring %}
                        {% if 'page' in querystring %}
                            <li><a href="{{ querystring|slice:":-1" }}{{ i }}">{{i}}</a></li>
                        {% else %}
                            <li><a href="{{ querystring }}&page={{ i }}">{{i}}</a></li>
                        {% endif %}
                    {% else %}
                        <li><a href="/?page={{ i }}">{{i}}</a></li>
                    {% endif %}
                {% endif %}
            {% endfor %}
            {% if projects.has_next %}
                {% if 'Status' in querystring %}
                    {% if 'page' in querystring %}
                        <li><a href="{{ querystring|slice:":-1" }}{{ projects.next_page_number }}">&raquo;</a></li>
                    {% else %}
                        <li><a href="{{ querystring }}&page={{ projects.next_page_number }}">&raquo;</a></li>
                    {% endif %}
                {% else %}
                    <li><a href="/?page={{ projects.next_page_number }}">&raquo;</a></li>
                {% endif %}
            {% endif %}
        </ul>
    {% endif %}
{% endwith %}
{% endblock content %}